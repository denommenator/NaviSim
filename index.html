<!DOCTYPE html>
<html lang="en">
<body id="body">
<p>
Start Position:
<form id="start_position_form">
    <ul>
        <li>
            (x) 
            <span>
                <input type="number" id="start_x" />
            </span>
        </li>
        <li>
            (y) 
            <span>
                <input type="number" id="start_y" />
            </span>
            </li>
            <li>
            (start angle) 
            <span>
                <input type="number" id="start_angle" />
            </span>
            </li>
            
        
        
        </li>
    </ul>
    <button type="submit">Reset Start Position</button>
</form>
</p>
<p>
Add commands:

<ul>
<li>
<form id="drive_straight_form">
    <label>Drive straight: 
        <span>
            <input type="number" id="distance" />
        </span>
        <input type="radio" id="forwards" value="forwards" name="backwards_toggle" checked="checked">
        <label for="forwards">(forwards)</label></input>
        <input type="radio" id="backwards" value="backwards" name="backwards_toggle">
        <label for="backwards">(backwards)</label></input>
    </label>
    <button type="submit">Add command</button>
</form>
</li>
<li>
<form id="turn_form">
    <label>Turn: 
        <span>
            <input type="number" id="degrees" />
        </span>
        <input type="radio" id="left" value="left" name="turn_toggle" checked="checked">
        <label for="left">(left)</label></input>
        <input type="radio" id="right" value="right" name="turn_toggle">
        <label for="right">(right)</label></input>
    </label>
    <button type="submit">Add command</button>
</form>
</li>
<li>
    <form id="pop_direction_form">
        <label>Delete Direction: 
        <button type="submit">Delete Last Direction</button>
    </form>
    </li>
</ul>
</p>

<p id="directions_display"></p>

<p id="log"></p>

<script src = "vector.js"></script>
<script src = "directions.js"></script>
<script>
    
    let startPoint = new Vec2(400, 0)
    let startAngle = 90
    daaata = new Directions(startPoint, startAngle)

    function updateDirectionsDisplay()
    {
        while (directions_display.firstChild) {
            directions_display.removeChild(directions_display.firstChild);
        }
        serializeDirections(daaata, directions_display)
    }

    function startPositionSubmit(event) {
        var backwardsSelector = document.querySelector( 'input[name="backwards_toggle"]:checked');   
        
        log.textContent = `Start position update submitted! (` + start_x.value + ", " + start_y.value + ") angle: " + start_angle.value
        daaata.startPoint = new Vec2(start_x.value, start_y.value)
        daaata.startAngle = start_angle.value
        
        updateDirectionsDisplay()
        event.preventDefault()
    }

    function driveStraightSubmit(event) {
        var backwardsSelector = document.querySelector( 'input[name="backwards_toggle"]:checked');   
        
        log.textContent = `Drive straight submitted! ` + distance.value + " " + backwardsSelector.value;
        let backwards_flag = backwardsSelector.value == 'forwards' ? DriveStraightDirection.Forward : DriveStraightDirection.Backward
        daaata.push_direction(new Straight(distance.value, backwards_flag))

        updateDirectionsDisplay()
        event.preventDefault()
    }

    function turnSubmit(event) {
        var directionSelector = document.querySelector( 'input[name="turn_toggle"]:checked');   
        
        log.textContent = `Turn submitted! ` + degrees.value + " " + directionSelector.value;
        let direction_flag = directionSelector.value == 'left' ? TurnDirection.Left : TurnDirection.Right
        daaata.push_direction(new Turn(degrees.value, direction_flag))

        updateDirectionsDisplay()
        event.preventDefault()
    }

    function popDirectionSubmit(event) {
        var directionSelector = document.querySelector( 'input[name="turn_toggle"]:checked');   
        
        log.textContent = `Direction delete submitted! `
        daaata.pop_direction()

        updateDirectionsDisplay()
        event.preventDefault()
    }

    const startPositionForm = document.getElementById("start_position_form")
    const driveStraightForm = document.getElementById("drive_straight_form")
    const turnForm = document.getElementById("turn_form")
    const popDirectionForm = document.getElementById("pop_direction_form")
    const log = document.getElementById("log")
    
    startPositionForm.addEventListener("submit", startPositionSubmit)
    driveStraightForm.addEventListener("submit", driveStraightSubmit)
    turnForm.addEventListener("submit", turnSubmit)
    popDirectionForm.addEventListener("submit", popDirectionSubmit)


</script>
</body>
</html>